apiVersion: v1
kind: Secret
metadata:
  name: smtp-defaults
  labels:
    app: {{ include "dashboard.name" . }}
    chart: {{ include "dashboard.chart" . }}
    release: {{ .Release.Name }}
    heritage: {{ .Release.Service }}
  annotations:
    "helm.sh/hook": pre-install,pre-upgrade,pre-rollback
    "helm.sh/hook-delete-policy": "before-hook-creation"
type: Opaque
data:
  SMTP_HOST: {{ default "localhost" .Values.smtp.host | b64enc | quote }}
  {{ if .Values.smtp.port }}SMTP_PORT: {{ printf "%s" .Values.smtp.port | b64enc | quote }}{{ end }}
  {{ if .Values.smtp.tls  }}SMTP_USE_TLS: {{ b64enc "yes" | quote }}{{ end }}
  {{ if .Values.smtp.user }}SMTP_USER: {{ .Values.smtp.user | b64enc | quote }}{{ end }}
  {{ if .Values.smtp.password }}SMTP_PASS: {{ .Values.smtp.pass | b64enc | quote }}{{ end }}
