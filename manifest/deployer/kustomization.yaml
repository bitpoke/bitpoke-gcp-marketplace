# resources that will be deployed by the deploy
resources:
  - ../charts/stack/templates/application.yaml

  # dashbaord
  - ../charts/dashboard/templates/apiserver-deployment.yaml
  - ../charts/dashboard/templates/apiserver-ingress.yaml
  - ../charts/dashboard/templates/apiserver-oidc-secret.yaml
  - ../charts/dashboard/templates/apiserver-service.yaml
  - ../charts/dashboard/templates/apiserver-sentry-secret.yaml
  - ../charts/dashboard/templates/controller-deployment.yaml
  - ../charts/dashboard/templates/controller-gcloud-serviceaccount.yaml
  - ../charts/dashboard/templates/webhook-service.yaml
  - ../charts/dashboard/templates/webhook-pki.yaml

  # cert-manager objects
  - ../charts/stack/charts/cert-manager/charts/webhook/templates/service.yaml
  - ../charts/stack/charts/cert-manager/charts/webhook/templates/deployment.yaml
  - ../charts/stack/charts/cert-manager/charts/cainjector/templates/deployment.yaml
  - ../charts/stack/charts/cert-manager/templates/deployment.yaml
  - ../charts/stack/charts/cert-manager/charts/webhook/templates/pki.yaml

  # prometheus-operator objects
  - ../charts/stack/charts/prometheus-operator/templates/prometheus-operator/service.yaml
  - ../charts/stack/charts/prometheus-operator/templates/prometheus-operator/deployment.yaml
  - ../charts/stack/charts/prometheus-operator/templates/prometheus-operator/servicemonitor.yaml
  - ../charts/stack/charts/prometheus-operator/templates/prometheus/service.yaml
  - ../charts/stack/charts/prometheus-operator/templates/prometheus/prometheus.yaml
  - ../charts/stack/charts/prometheus-operator/templates/prometheus/servicemonitor.yaml



  # nginx-ingress controller
  - ../charts/stack/charts/nginx-ingress/templates/controller-deployment.yaml
  - ../charts/stack/charts/nginx-ingress/templates/controller-configmap.yaml
  - ../charts/stack/charts/nginx-ingress/templates/controller-service.yaml
  - ../charts/stack/charts/nginx-ingress/templates/default-backend-deployment.yaml
  - ../charts/stack/charts/nginx-ingress/templates/default-backend-service.yaml

  # mysql operator
  - ../charts/stack/charts/mysql-operator/templates/statefulset.yaml
  - ../charts/stack/charts/mysql-operator/templates/orc-service.yaml
  - ../charts/stack/charts/mysql-operator/templates/orc-secret.yaml
  - ../charts/stack/charts/mysql-operator/templates/orc-config.yaml

  # wordpress operator
  - ../charts/stack/charts/wordpress-operator/templates/deployment.yaml


patchesJson6902:
# cert-manager fix service accounts
- target:
    group: apps
    version: v1beta1
    kind: Deployment
    name: ${name}-cert-manager-cainjector
  path: service_account_patch.yaml
- target:
    group: apps
    version: v1beta1
    kind: Deployment
    name: ${name}-cert-manager-webhook
  path: service_account_patch.yaml

# nginx-ingress controller image tag patch
- target:
    group: extensions
    version: v1beta1
    kind: Deployment
    name: ${name}-nginx-ingress-controller
  path: ingress_image_tag.yaml

# mysql-operator passowrds
- target:
    version: v1
    kind: Secret
    name: ${name}-mysql-operator-orc
  path: mysql_secret.yaml

# dashboard secrets to bypass base64 encode
- target:
    version: v1
    kind: Secret
    name: ${name}-dashboard-oidc
  path: dashboard_oidc_secret.yaml
- target:
    version: v1
    kind: Secret
    name: ${name}-dashboard-gcloud
  path: dashboard_serviceaccount_secret.yaml

# prometheus
- target:
    group: monitoring.coreos.com
    version: v1
    kind: Prometheus
    name: ${name}-prometheus-prometheus
  path: prometheus_tag.yaml
