# resources that will be deployed by the job
resources:
  # dashboard
  - ../../charts/dashboard/templates/webhook.yaml
  - ../../charts/dashboard/templates/default-roles.yaml
  - ../../charts/dashboard/templates/impersontator-clusterrole.yaml
  - ../../charts/dashboard/templates/prometheus-clusterrole.yaml

  # stack
  - ../../charts/stack/templates/acme-issuer.yaml

  # cert manager
  - ../../charts/stack/charts/cert-manager/charts/webhook/templates/pki.yaml
  - ../../charts/stack/charts/cert-manager/charts/webhook/templates/apiservice.yaml
  - ../../charts/stack/charts/cert-manager/charts/webhook/templates/validating-webhook.yaml

  # prometheus
  - ../../charts/stack/charts/prometheus-operator/templates/prometheus-operator/servicemonitor.yaml
  - ../../charts/stack/charts/prometheus-operator/templates/prometheus/prometheus.yaml
  - ../../charts/stack/charts/prometheus-operator/templates/prometheus/servicemonitor.yaml


commonLabels:
  "dashboard.presslabs.com/version": "0.0.1"

patchesJson6902:
# cert-manager set owner reference
- target:
    group: admissionregistration.k8s.io
    version: v1beta1
    kind: ValidatingWebhookConfiguration
    name: ${name}-cert-wh
  path: owner_reference_patch.yaml

- target:
    group: monitoring.coreos.com
    version: v1
    kind: Prometheus
    name: ${name}-prom-prometheus
  path: prometheus_tag.yaml
